<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QRC Wallet - Quantum Resistant Blockchain</title>
    <link rel="icon" type="image/x-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' fill='%2300ff88' rx='20'/></svg>">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif; background: linear-gradient(135deg, #0f0f23 0%, #1a1a3e 100%); color: #ffffff; min-height: 100vh; display: flex; flex-direction: column; align-items: center; padding: 20px; }
        
        /* Login Screen Styles */
        .login-container { 
            width: 100%; 
            max-width: 400px; 
            background: rgba(255, 255, 255, 0.05); 
            padding: 40px; 
            border-radius: 24px; 
            backdrop-filter: blur(20px); 
            border: 1px solid rgba(255, 255, 255, 0.1); 
            margin-top: 100px;
        }
        .login-logo { text-align: center; margin-bottom: 30px; }
        .login-logo .logo { width: 80px; height: 80px; background: #00ff88; border-radius: 20px; display: inline-flex; align-items: center; justify-content: center; font-size: 36px; font-weight: bold; color: #000; margin-bottom: 20px; }
        .login-title { font-size: 24px; text-align: center; margin-bottom: 10px; }
        .login-subtitle { color: #999; text-align: center; margin-bottom: 30px; }
        .input-group { margin-bottom: 20px; }
        .input-label { display: block; margin-bottom: 8px; color: #999; font-size: 14px; }
        .input-field { width: 100%; padding: 15px; border: 2px solid rgba(255, 255, 255, 0.1); border-radius: 8px; background: rgba(255, 255, 255, 0.05); color: white; font-size: 16px; transition: all 0.3s; }
        .input-field:focus { outline: none; border-color: #00ff88; background: rgba(255, 255, 255, 0.08); }
        .password-toggle { position: relative; }
        .password-toggle-btn { position: absolute; right: 15px; top: 50%; transform: translateY(-50%); background: none; border: none; color: #999; cursor: pointer; font-size: 20px; }
        .error-message { background: rgba(255, 107, 107, 0.1); border: 1px solid #ff6b6b; padding: 10px; border-radius: 8px; margin-bottom: 20px; font-size: 14px; display: none; }
        .success-message { background: rgba(0, 255, 136, 0.1); border: 1px solid #00ff88; padding: 10px; border-radius: 8px; margin-bottom: 20px; font-size: 14px; display: none; }
        
        /* 6-digit code input styles */
        .code-input-container {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-bottom: 20px;
        }
        .code-input {
            width: 45px;
            height: 50px;
            text-align: center;
            font-size: 24px;
            font-weight: bold;
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.05);
            color: white;
            transition: all 0.3s;
        }
        .code-input:focus {
            outline: none;
            border-color: #00ff88;
            background: rgba(255, 255, 255, 0.08);
            transform: scale(1.1);
        }
        
        /* Main App Styles */
        .app-container { width: 100%; display: none; }
        .main-header { width: 100%; max-width: 1200px; display: flex; justify-content: space-between; align-items: center; margin: 0 auto 40px; padding: 20px 0; }
        .logo-section { display: flex; align-items: center; gap: 15px; }
        .logo { width: 50px; height: 50px; background: #00ff88; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-weight: bold; color: #000; }
        .logo-text { font-size: 24px; font-weight: 700; }
        .nav-links { display: flex; gap: 30px; align-items: center; }
        .nav-link { color: #999; text-decoration: none; transition: color 0.3s; font-size: 14px; cursor: pointer; }
        .nav-link:hover { color: #00ff88; }
        .user-menu { display: flex; align-items: center; gap: 20px; }
        .user-info { display: flex; align-items: center; gap: 10px; padding: 8px 16px; background: rgba(255, 255, 255, 0.05); border-radius: 20px; }
        .user-avatar { width: 32px; height: 32px; background: #00ff88; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; color: #000; }
        .logout-btn { background: none; border: 1px solid #ff6b6b; color: #ff6b6b; padding: 8px 16px; border-radius: 8px; cursor: pointer; transition: all 0.3s; }
        .logout-btn:hover { background: #ff6b6b; color: white; }
        .network-indicator { display: flex; align-items: center; gap: 8px; background: rgba(0, 255, 136, 0.1); padding: 8px 16px; border-radius: 20px; font-size: 12px; }
        .network-dot { width: 8px; height: 8px; background: #00ff88; border-radius: 50%; animation: pulse 2s infinite; }
        .main-content { width: 100%; max-width: 1200px; display: grid; grid-template-columns: 1fr 1fr; gap: 40px; margin: 0 auto 40px; }
        .stats-section { display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; }
        .stat-card { background: rgba(255, 255, 255, 0.05); padding: 24px; border-radius: 16px; backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.1); transition: all 0.3s ease; }
        .stat-card:hover { transform: translateY(-5px); background: rgba(255, 255, 255, 0.08); }
        .stat-value { font-size: 32px; font-weight: 700; color: #00ff88; margin-bottom: 5px; }
        .stat-label { font-size: 12px; color: #999; text-transform: uppercase; letter-spacing: 1px; }
        .wallet-section { background: rgba(255, 255, 255, 0.05); padding: 40px; border-radius: 24px; backdrop-filter: blur(20px); border: 1px solid rgba(255, 255, 255, 0.1); box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3); }
        .wallet-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; }
        .wallet-title { font-size: 20px; font-weight: 600; }
        .wallet-menu { display: flex; gap: 10px; }
        .menu-button { background: none; border: none; color: #999; cursor: pointer; padding: 8px; transition: color 0.3s; }
        .menu-button:hover { color: #00ff88; }
        .security-status { display: flex; align-items: center; gap: 10px; background: rgba(0, 255, 136, 0.1); padding: 8px 16px; border-radius: 20px; margin-bottom: 20px; }
        .security-icon { color: #00ff88; }
        .algorithm-badge { display: inline-flex; align-items: center; gap: 8px; background: rgba(0, 255, 136, 0.1); padding: 6px 12px; border-radius: 20px; font-size: 12px; color: #00ff88; margin-bottom: 20px; }
        .algorithm-badge .badge-icon { width: 16px; height: 16px; background: #00ff88; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 10px; color: #000; font-weight: bold; }
        .wallet-display { background: rgba(0, 0, 0, 0.3); padding: 24px; border-radius: 16px; margin-bottom: 30px; }
        .wallet-address-container { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .wallet-label { font-size: 12px; color: #999; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 8px; }
        .wallet-address { font-family: 'Courier New', monospace; font-size: 14px; word-break: break-all; cursor: pointer; transition: color 0.3s; }
        .wallet-address:hover { color: #00ff88; }
        .address-actions { display: flex; gap: 10px; }
        .balance-display { text-align: center; padding: 30px 0; border-bottom: 1px solid rgba(255, 255, 255, 0.1); margin-bottom: 30px; }
        .balance-label { font-size: 14px; color: #999; margin-bottom: 10px; }
        .balance-amount { font-size: 48px; font-weight: 700; background: linear-gradient(45deg, #00ff88, #00ffff); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin-bottom: 5px; }
        .balance-usd { font-size: 18px; color: #999; }
        .button { width: 100%; padding: 16px; border: none; border-radius: 12px; font-size: 16px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; margin-bottom: 12px; display: flex; align-items: center; justify-content: center; gap: 10px; }
        .button-primary { background: linear-gradient(45deg, #00ff88, #00cc77); color: #000; }
        .button-primary:hover { transform: translateY(-2px); box-shadow: 0 10px 20px rgba(0, 255, 136, 0.3); }
        .button-secondary { background: transparent; color: #00ff88; border: 2px solid #00ff88; }
        .button-secondary:hover { background: #00ff88; color: #000; }
        .tabs { display: flex; border-bottom: 1px solid rgba(255, 255, 255, 0.1); margin-bottom: 30px; }
        .tab { padding: 12px 24px; cursor: pointer; color: #999; transition: all 0.3s; border-bottom: 2px solid transparent; }
        .tab.active { color: #00ff88; border-bottom-color: #00ff88; }
        .tab:hover { color: #00ff88; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        
        .transaction-item { background: rgba(255, 255, 255, 0.05); padding: 16px; border-radius: 12px; margin-bottom: 12px; display: flex; justify-content: space-between; align-items: center; transition: all 0.3s; animation: fadeIn 0.3s ease-out; }
        .transaction-item:hover { background: rgba(255, 255, 255, 0.08); }
        .transaction-icon { width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 20px; margin-right: 15px; }
        .transaction-icon.received { background: rgba(0, 255, 136, 0.1); color: #00ff88; }
        .transaction-icon.sent { background: rgba(255, 107, 107, 0.1); color: #ff6b6b; }
        .transaction-details { flex: 1; }
        .transaction-type { font-weight: 600; margin-bottom: 4px; }
        .transaction-address { font-size: 12px; color: #999; font-family: monospace; }
        .transaction-time { font-size: 11px; color: #666; margin-top: 4px; }
        .transaction-amount { text-align: right; }
        .transaction-value { font-weight: 600; font-size: 16px; }
        .transaction-value.positive { color: #00ff88; }
        .transaction-value.negative { color: #ff6b6b; }
        .transaction-usd { font-size: 12px; color: #999; }
        .empty-state { text-align: center; padding: 60px 20px; color: #999; }
        .empty-state-icon { font-size: 48px; margin-bottom: 20px; opacity: 0.5; }
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.9); align-items: center; justify-content: center; z-index: 1000; padding: 20px; }
        .modal-content { background: #1a1a3e; padding: 40px; border-radius: 24px; max-width: 500px; width: 100%; max-height: 90vh; overflow-y: auto; animation: fadeIn 0.3s ease-out; }
        .modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; }
        .modal-title { font-size: 24px; font-weight: 600; }
        .close-modal { background: none; border: none; color: #999; font-size: 24px; cursor: pointer; padding: 0; width: 32px; height: 32px; display: flex; align-items: center; justify-content: center; border-radius: 50%; transition: all 0.3s; }
        .close-modal:hover { background: rgba(255, 255, 255, 0.1); color: #fff; }
        .qr-container { background: #fff; padding: 30px; border-radius: 16px; text-align: center; }
        .qr-title { color: #000; font-size: 18px; margin-bottom: 20px; }
        #qrcode, #receiveQrcode { margin: 0 auto 20px; display: inline-block; }
        .qr-address { background: #f5f5f5; padding: 12px; border-radius: 8px; font-family: 'Courier New', monospace; font-size: 12px; color: #000; word-break: break-all; margin-bottom: 20px; }
        .notification { position: fixed; bottom: 20px; right: 20px; background: #00ff88; color: #000; padding: 16px 24px; border-radius: 12px; font-weight: 600; animation: slideIn 0.3s ease-out; display: none; z-index: 2000; max-width: 400px; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3); }
        .notification.error { background: #ff6b6b; color: #fff; }
        .notification.warning { background: #ffa500; color: #000; }
        .notification.info { background: #3498db; color: #fff; }
        .notification.success { background: #00ff88; color: #000; }
        
        /* Import tab styles */
        .import-tab-content { display: none; }
        .seed-phrase-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-bottom: 15px; }
        .seed-input { width: 100%; padding: 10px; text-align: center; font-size: 14px; font-family: monospace; border: 2px solid rgba(255, 255, 255, 0.1); border-radius: 8px; background: rgba(255, 255, 255, 0.05); color: white; transition: all 0.3s; }
        .seed-input:focus { outline: none; border-color: #00ff88; background: rgba(255, 255, 255, 0.08); transform: scale(1.05); }
        .seed-input::placeholder { color: rgba(255, 255, 255, 0.3); font-size: 12px; }
        
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes pulse { 0%, 100% { transform: scale(1); opacity: 1; } 50% { transform: scale(1.2); opacity: 0.8; } }
        @keyframes slideIn { from { opacity: 0; transform: translateX(100px); } to { opacity: 1; transform: translateX(0); } }
        
        @media (max-width: 968px) { 
            .main-content { grid-template-columns: 1fr; } 
            .main-header { flex-direction: column; gap: 20px; }
            .nav-links { flex-wrap: wrap; justify-content: center; }
        }
        @media (max-width: 768px) { 
            .stats-section { grid-template-columns: 1fr; } 
            .wallet-section { padding: 24px; } 
            .balance-amount { font-size: 36px; }
            .transaction-item { flex-direction: column; align-items: flex-start; gap: 10px; }
            .transaction-amount { align-self: flex-end; }
            .seed-phrase-grid { grid-template-columns: repeat(3, 1fr); gap: 8px; }
        }
        @media (max-width: 480px) {
            .seed-phrase-grid { grid-template-columns: repeat(2, 1fr); gap: 6px; }
        }
    </style>
</head>
<body>
    <!-- Login Screen -->
    <div class="login-container" id="loginScreen">
        <div class="login-logo">
            <div class="logo">QRC</div>
        </div>
        <h1 class="login-title">Quantum Wallet</h1>
        <p class="login-subtitle">Secure access to your quantum-resistant blockchain</p>
        
        <div class="error-message" id="loginError"></div>
        <div class="success-message" id="loginSuccess"></div>
        
        <div id="loginForm">
            <div class="input-group">
                <label class="input-label">Wallet Password</label>
                <div class="password-toggle">
                    <input type="password" class="input-field" id="walletPassword" placeholder="Enter your secure password" autocomplete="new-password">
                    <button class="password-toggle-btn" onclick="togglePassword('walletPassword')">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/>
                        </svg>
                    </button>
                </div>
            </div>
            
            <div class="input-group" id="login2FAField" style="display: none;">
                <label class="input-label">Google Authenticator Code</label>
                <div class="code-input-container">
                    <input type="text" class="code-input" id="code1" maxlength="1" oninput="moveToNext(this, 'code2')" autocomplete="off">
                    <input type="text" class="code-input" id="code2" maxlength="1" oninput="moveToNext(this, 'code3')" autocomplete="off">
                    <input type="text" class="code-input" id="code3" maxlength="1" oninput="moveToNext(this, 'code4')" autocomplete="off">
                    <input type="text" class="code-input" id="code4" maxlength="1" oninput="moveToNext(this, 'code5')" autocomplete="off">
                    <input type="text" class="code-input" id="code5" maxlength="1" oninput="moveToNext(this, 'code6')" autocomplete="off">
                    <input type="text" class="code-input" id="code6" maxlength="1" oninput="moveToNext(this, '')" autocomplete="off">
                </div>
            </div>
            
            <button class="button button-primary" onclick="attemptLogin()">
                <span>🔐</span>
                <span>Unlock Wallet</span>
            </button>
            
            <button class="button button-secondary" onclick="showCreateNewWallet()">
                <span>✨</span>
                <span>Create New Wallet</span>
            </button>
            
            <button class="button button-secondary" onclick="showImportWallet()">
                <span>📥</span>
                <span>Import Existing Wallet</span>
            </button>
        </div>
        
        <div id="createWalletForm" style="display: none;">
            <div class="input-group">
                <label class="input-label">Create Password (min 8 characters)</label>
                <div class="password-toggle">
                    <input type="password" class="input-field" id="newPassword" placeholder="Create a strong password" autocomplete="new-password">
                    <button class="password-toggle-btn" onclick="togglePassword('newPassword')">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/>
                        </svg>
                    </button>
                </div>
            </div>
            
            <div class="input-group">
                <label class="input-label">Confirm Password</label>
                <div class="password-toggle">
                    <input type="password" class="input-field" id="confirmPassword" placeholder="Confirm your password" autocomplete="new-password">
                    <button class="password-toggle-btn" onclick="togglePassword('confirmPassword')">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/>
                        </svg>
                    </button>
                </div>
            </div>
            
            <button class="button button-primary" onclick="createNewWallet()">
                <span>🚀</span>
                <span>Create Secure Wallet</span>
            </button>
            
            <button class="button button-secondary" onclick="backToLogin()">
                <span>←</span>
                <span>Back to Login</span>
            </button>
        </div>
        
        <div id="importWalletForm" style="display: none;">
            <div style="margin-bottom: 20px;">
                <div class="tabs" style="margin-bottom: 20px;">
                    <div class="tab active" onclick="showImportTab('code', this)">Import with Code</div>
                    <div class="tab" onclick="showImportTab('seed', this)">Import with Seed Phrase</div>
                </div>
            </div>
            
            <!-- Import with Code Tab -->
            <div id="importCodeTab" class="import-tab-content" style="display: block;">
                <div class="input-group">
                    <label class="input-label">Import Code</label>
                    <input type="text" class="input-field" id="importCode" placeholder="Enter your import code" autocomplete="off">
                </div>
                
                <div class="input-group">
                    <label class="input-label">New Password for QRC Wallet</label>
                    <div class="password-toggle">
                        <input type="password" class="input-field" id="importCodePassword" placeholder="Create password for this device" autocomplete="new-password">
                        <button class="password-toggle-btn" onclick="togglePassword('importCodePassword')">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/>
                            </svg>
                        </button>
                    </div>
                </div>
                
                <div class="input-group" id="importCode2FAField" style="display: none;">
                    <label class="input-label">Google Authenticator Code</label>
                    <div class="code-input-container">
                        <input type="text" class="code-input" id="importCode1" maxlength="1" oninput="moveToNext(this, 'importCode2')" autocomplete="off">
                        <input type="text" class="code-input" id="importCode2" maxlength="1" oninput="moveToNext(this, 'importCode3')" autocomplete="off">
                        <input type="text" class="code-input" id="importCode3" maxlength="1" oninput="moveToNext(this, 'importCode4')" autocomplete="off">
                        <input type="text" class="code-input" id="importCode4" maxlength="1" oninput="moveToNext(this, 'importCode5')" autocomplete="off">
                        <input type="text" class="code-input" id="importCode5" maxlength="1" oninput="moveToNext(this, 'importCode6')" autocomplete="off">
                        <input type="text" class="code-input" id="importCode6" maxlength="1" oninput="moveToNext(this, '')" autocomplete="off">
                    </div>
                </div>
                
                <button class="button button-primary" onclick="importWithCode()">
                    <span>📥</span>
                    <span>Import with Code</span>
                </button>
            </div>
            
            <!-- Import with Seed Phrase Tab -->
            <div id="importSeedTab" class="import-tab-content" style="display: none;">
                <div class="input-group">
                    <label class="input-label">24-Word Seed Phrase</label>
                    <div class="seed-phrase-grid">
                        <input type="text" class="seed-input" placeholder="1" id="seed1" oninput="moveToNextSeed(this, 1)" autocomplete="off">
                        <input type="text" class="seed-input" placeholder="2" id="seed2" oninput="moveToNextSeed(this, 2)" autocomplete="off">
                        <input type="text" class="seed-input" placeholder="3" id="seed3" oninput="moveToNextSeed(this, 3)" autocomplete="off">
                        <input type="text" class="seed-input" placeholder="4" id="seed4" oninput="moveToNextSeed(this, 4)" autocomplete="off">
                        <input type="text" class="seed-input" placeholder="5" id="seed5" oninput="moveToNextSeed(this, 5)" autocomplete="off">
                        <input type="text" class="seed-input" placeholder="6" id="seed6" oninput="moveToNextSeed(this, 6)" autocomplete="off">
                        <input type="text" class="seed-input" placeholder="7" id="seed7" oninput="moveToNextSeed(this, 7)" autocomplete="off">
                        <input type="text" class="seed-input" placeholder="8" id="seed8" oninput="moveToNextSeed(this, 8)" autocomplete="off">
                        <input type="text" class="seed-input" placeholder="9" id="seed9" oninput="moveToNextSeed(this, 9)" autocomplete="off">
                        <input type="text" class="seed-input" placeholder="10" id="seed10" oninput="moveToNextSeed(this, 10)" autocomplete="off">
                        <input type="text" class="seed-input" placeholder="11" id="seed11" oninput="moveToNextSeed(this, 11)" autocomplete="off">
                        <input type="text" class="seed-input" placeholder="12" id="seed12" oninput="moveToNextSeed(this, 12)" autocomplete="off">
                        <input type="text" class="seed-input" placeholder="13" id="seed13" oninput="moveToNextSeed(this, 13)" autocomplete="off">
                        <input type="text" class="seed-input" placeholder="14" id="seed14" oninput="moveToNextSeed(this, 14)" autocomplete="off">
                        <input type="text" class="seed-input" placeholder="15" id="seed15" oninput="moveToNextSeed(this, 15)" autocomplete="off">
                        <input type="text" class="seed-input" placeholder="16" id="seed16" oninput="moveToNextSeed(this, 16)" autocomplete="off">
                        <input type="text" class="seed-input" placeholder="17" id="seed17" oninput="moveToNextSeed(this, 17)" autocomplete="off">
                        <input type="text" class="seed-input" placeholder="18" id="seed18" oninput="moveToNextSeed(this, 18)" autocomplete="off">
                        <input type="text" class="seed-input" placeholder="19" id="seed19" oninput="moveToNextSeed(this, 19)" autocomplete="off">
                        <input type="text" class="seed-input" placeholder="20" id="seed20" oninput="moveToNextSeed(this, 20)" autocomplete="off">
                        <input type="text" class="seed-input" placeholder="21" id="seed21" oninput="moveToNextSeed(this, 21)" autocomplete="off">
                        <input type="text" class="seed-input" placeholder="22" id="seed22" oninput="moveToNextSeed(this, 22)" autocomplete="off">
                        <input type="text" class="seed-input" placeholder="23" id="seed23" oninput="moveToNextSeed(this, 23)" autocomplete="off">
                        <input type="text" class="seed-input" placeholder="24" id="seed24" oninput="moveToNextSeed(this, 24)" autocomplete="off">
                    </div>
                </div>
                
                <div class="input-group">
                    <label class="input-label">New Password for QRC Wallet</label>
                    <div class="password-toggle">
                        <input type="password" class="input-field" id="importSeedPassword" placeholder="Create password for this device" autocomplete="new-password">
                        <button class="password-toggle-btn" onclick="togglePassword('importSeedPassword')">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/>
                            </svg>
                        </button>
                    </div>
                </div>
                
                <div class="input-group" id="importSeed2FAField" style="display: none;">
                    <label class="input-label">Google Authenticator Code (if enabled)</label>
                    <div class="code-input-container">
                        <input type="text" class="code-input" id="importSeedCode1" maxlength="1" oninput="moveToNext(this, 'importSeedCode2')" autocomplete="off">
                        <input type="text" class="code-input" id="importSeedCode2" maxlength="1" oninput="moveToNext(this, 'importSeedCode3')" autocomplete="off">
                        <input type="text" class="code-input" id="importSeedCode3" maxlength="1" oninput="moveToNext(this, 'importSeedCode4')" autocomplete="off">
                        <input type="text" class="code-input" id="importSeedCode4" maxlength="1" oninput="moveToNext(this, 'importSeedCode5')" autocomplete="off">
                        <input type="text" class="code-input" id="importSeedCode5" maxlength="1" oninput="moveToNext(this, 'importSeedCode6')" autocomplete="off">
                        <input type="text" class="code-input" id="importSeedCode6" maxlength="1" oninput="moveToNext(this, '')" autocomplete="off">
                    </div>
                </div>
                
                <button class="button button-primary" onclick="importWithSeedPhrase()">
                    <span>📥</span>
                    <span>Import with Seed Phrase</span>
                </button>
            </div>
            
            <button class="button button-secondary" onclick="backToLogin()">
                <span>←</span>
                <span>Back to Login</span>
            </button>
        </div>
    </div>

    <!-- Main App -->
    <div class="app-container" id="appContainer">
        <header class="main-header">
            <div class="logo-section">
                <div class="logo">QRC</div>
                <div class="logo-text">Quantum Wallet</div>
            </div>
            <div class="user-menu">
                <div class="network-indicator">
                    <div class="network-dot"></div>
                    <span>Mainnet</span>
                </div>
                <div class="user-info">
                    <div class="user-avatar" id="userAvatar">U</div>
                    <span id="userDisplay">User</span>
                </div>
                <button class="logout-btn" onclick="logout()">Logout</button>
            </div>
        </header>

        <div class="main-content">
            <div class="stats-section">
                <div class="stat-card">
                    <div class="stat-value" id="currentTPS">0</div>
                    <div class="stat-label">Current TPS</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="totalBlocks">0</div>
                    <div class="stat-label">Total Blocks</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="totalTransactions">0</div>
                    <div class="stat-label">Transactions</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="activeUsers">0</div>
                    <div class="stat-label">Active Users</div>
                </div>
            </div>

            <div class="wallet-section">
                <div class="wallet-header">
                    <h2 class="wallet-title">Quantum Resistant Wallet</h2>
                </div>

                <div class="security-status">
                    <span class="security-icon">🔒</span>
                    <span>Secured with password + Google Authenticator + encryption</span>
                </div>

                <div class="algorithm-badge">
                    <div class="badge-icon">✓</div>
                    <span>Protected by CRYSTALS-Dilithium</span>
                </div>

                <div class="wallet-display">
                    <div class="wallet-label">Your Wallet Address</div>
                    <div class="wallet-address-container">
                        <div class="wallet-address" id="walletAddress" onclick="copyAddress()"></div>
                        <div class="address-actions">
                            <button class="menu-button" onclick="showQRModal()" title="Show QR Code">📱</button>
                            <button class="menu-button" onclick="copyAddress()" title="Copy Address">📋</button>
                        </div>
                    </div>
                </div>

                <div class="balance-display">
                    <div class="balance-label">Total Balance</div>
                    <div class="balance-amount" id="balanceAmount">0.00 QRC</div>
                    <div class="balance-usd" id="balanceUSD">≈ $0.00 USD</div>
                </div>

                <div class="tabs">
                    <div class="tab active" onclick="showTab('wallet', this)">Wallet</div>
                    <div class="tab" onclick="showTab('history', this)">History</div>
                    <div class="tab" onclick="showTab('settings', this)">Settings</div>
                </div>

                <div id="walletTab" class="tab-content active">
                    <button class="button button-primary" onclick="showSendModal()">
                        <span>📤</span>
                        <span>Send QRC</span>
                    </button>
                    <button class="button button-secondary" onclick="showReceiveModal()">
                        <span>📥</span>
                        <span>Receive</span>
                    </button>
                    <button class="button button-secondary" onclick="getFaucet()">
                        <span>💧</span>
                        <span>Test Faucet (100 QRC daily)</span>
                    </button>
                </div>

                <div id="historyTab" class="tab-content">
                    <div id="transactionHistory">
                        <div class="empty-state">
                            <div class="empty-state-icon">📊</div>
                            <p>No transactions yet</p>
                            <p style="font-size: 14px; margin-top: 10px;">Your transaction history will appear here</p>
                        </div>
                    </div>
                </div>

                <div id="settingsTab" class="tab-content">
                    <div style="background: rgba(255, 107, 107, 0.1); border: 1px solid #ff6b6b; border-radius: 12px; padding: 20px; margin-bottom: 20px;">
                        <h4 style="margin-bottom: 10px;">⚠️ Security Settings</h4>
                        <p style="font-size: 14px; line-height: 1.6;">Your wallet is encrypted with your password. Never share your seed phrase or password with anyone.</p>
                    </div>
                    <button class="button button-secondary" onclick="showNotification('2FA setup coming soon!', 'info')">
                        <span>🔐</span>
                        <span>Setup Google Authenticator</span>
                    </button>
                    <button class="button button-secondary" onclick="showNotification('Export feature coming soon!', 'info')">
                        <span>💾</span>
                        <span>Export Seed Phrase</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modals -->
    <div class="modal" id="sendModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Send QRC</h2>
                <button class="close-modal" onclick="closeModal('sendModal')">×</button>
            </div>
            
            <div style="margin-bottom: 20px;">
                <label style="display: block; margin-bottom: 8px; color: #999; font-size: 14px;">Recipient Address</label>
                <input type="text" id="recipientAddress" placeholder="QRC..." style="width: 100%; padding: 15px; border: 2px solid rgba(255, 255, 255, 0.1); border-radius: 8px; background: rgba(255, 255, 255, 0.05); color: white; font-size: 16px;" autocomplete="off">
            </div>
            
            <div style="margin-bottom: 20px;">
                <label style="display: block; margin-bottom: 8px; color: #999; font-size: 14px;">Amount (QRC)</label>
                <input type="number" id="sendAmount" placeholder="0.00" step="0.01" oninput="updateFeeDisplay()" style="width: 100%; padding: 15px; border: 2px solid rgba(255, 255, 255, 0.1); border-radius: 8px; background: rgba(255, 255, 255, 0.05); color: white; font-size: 16px;" autocomplete="off">
            </div>
            
            <div style="margin-bottom: 20px;">
                <label style="display: block; margin-bottom: 8px; color: #999; font-size: 14px;">Transaction Password</label>
                <div class="password-toggle">
                    <input type="password" id="sendPassword" placeholder="Enter your password" style="width: 100%; padding: 15px; border: 2px solid rgba(255, 255, 255, 0.1); border-radius: 8px; background: rgba(255, 255, 255, 0.05); color: white; font-size: 16px;" autocomplete="new-password">
                    <button class="password-toggle-btn" onclick="togglePassword('sendPassword')">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/>
                        </svg>
                    </button>
                </div>
            </div>
            
            <div style="background: rgba(255, 255, 255, 0.05); padding: 20px; border-radius: 12px; margin-bottom: 20px;">
                <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                    <span>Network Fee:</span>
                    <span id="feeDisplay">0.00 QRC</span>
                </div>
                <div style="display: flex; justify-content: space-between; font-weight: 600;">
                    <span>Total:</span>
                    <span id="totalDisplay">0.00 QRC</span>
                </div>
            </div>

            <button class="button button-primary" onclick="confirmSend()">
                Sign & Send Transaction
            </button>
        </div>
    </div>

    <div class="modal" id="receiveModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Receive QRC</h2>
                <button class="close-modal" onclick="closeModal('receiveModal')">×</button>
            </div>
            
            <div class="qr-container">
                <h3 class="qr-title">Your QRC Address</h3>
                <div id="receiveQrcode"></div>
                <div class="qr-address" id="receiveAddress"></div>
                <button class="button button-secondary" onclick="copyAddress()">Copy Address</button>
            </div>
        </div>
    </div>

    <div class="modal" id="qrModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">QR Code</h2>
                <button class="close-modal" onclick="closeModal('qrModal')">×</button>
            </div>
            
            <div class="qr-container">
                <h3 class="qr-title">Scan to Send QRC</h3>
                <div id="qrcode"></div>
                <div class="qr-address" id="qrAddress"></div>
                <button class="button button-secondary" onclick="copyAddress()">Copy Address</button>
            </div>
        </div>
    </div>

    <div class="notification" id="notification"></div>

    <script>
        // Global state
        let walletState = {
            address: null,
            seedPhrase: null,
            balance: 0,
            encryptedData: null,
            isLoggedIn: false,
            transactions: []
        };
        
        let sessionPassword = null;
        let qrcode = null;
        let receiveQrcode = null;

        // 6-digit code input helper
        function moveToNext(current, nextFieldId) {
            if (current.value.length >= current.maxLength) {
                if (nextFieldId && document.getElementById(nextFieldId)) {
                    document.getElementById(nextFieldId).focus();
                } else {
                    // If it's the last field, trigger login
                    if (current.id === 'code6') {
                        attemptLogin();
                    }
                }
            }
            // Handle backspace
            if (current.value.length === 0 && event.inputType === 'deleteContentBackward') {
                const currentNum = parseInt(current.id.replace('code', ''));
                if (currentNum > 1) {
                    document.getElementById(`code${currentNum - 1}`).focus();
                }
            }
        }

        // Utility functions
        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = 'notification ' + type;
            notification.style.display = 'block';
            
            setTimeout(() => {
                notification.style.display = 'none';
            }, 4000);
        }

        function togglePassword(fieldId) {
            const input = document.getElementById(fieldId);
            const toggle = input.nextElementSibling;
            
            if (input.type === 'password') {
                input.type = 'text';
                toggle.innerHTML = '<svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7zM2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3 2 4.27zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2zm4.31-.78l3.15 3.15.02-.16c0-1.66-1.34-3-3-3l-.17.01z"/></svg>';
            } else {
                input.type = 'password';
                toggle.innerHTML = '<svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>';
            }
        }

        function showError(message) {
            document.getElementById('loginError').textContent = message;
            document.getElementById('loginError').style.display = 'block';
            setTimeout(() => {
                document.getElementById('loginError').style.display = 'none';
            }, 5000);
        }

        function showSuccess(message) {
            document.getElementById('loginSuccess').textContent = message;
            document.getElementById('loginSuccess').style.display = 'block';
            setTimeout(() => {
                document.getElementById('loginSuccess').style.display = 'none';
            }, 5000);
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        // Login functions
        function attemptLogin() {
            const password = document.getElementById('walletPassword').value;
            
            if (!password) {
                showError('Please enter your password');
                return;
            }
            
            const encryptedWallet = localStorage.getItem('qrcWalletEncrypted');
            if (!encryptedWallet) {
                showError('No wallet found. Please create a new wallet.');
                return;
            }
            
            try {
                // Decrypt wallet data
                const decrypted = CryptoJS.AES.decrypt(encryptedWallet, password);
                const decryptedStr = decrypted.toString(CryptoJS.enc.Utf8);
                
                if (!decryptedStr) {
                    showError('Invalid password');
                    return;
                }
                
                walletState = JSON.parse(decryptedStr);
                
                // Check if 2FA is required
                if (walletState.twoFactorEnabled) {
                    if (document.getElementById('login2FAField').style.display === 'none') {
                        document.getElementById('login2FAField').style.display = 'block';
                        document.getElementById('code1').focus();
                        return;
                    }
                    
                    // Get code from 6 inputs
                    let code = '';
                    for (let i = 1; i <= 6; i++) {
                        code += document.getElementById(`code${i}`).value;
                    }
                    
                    if (code.length !== 6) {
                        showError('Please enter the complete 6-digit code');
                        return;
                    }
                    
                    // Verify 2FA code here (simplified for demo)
                    // In production, verify against TOTP
                }
                
                walletState.isLoggedIn = true;
                sessionPassword = password;
                
                // Show main app
                document.getElementById('loginScreen').style.display = 'none';
                document.getElementById('appContainer').style.display = 'block';
                
                // Initialize app
                initializeApp();
                showNotification('Welcome back! Wallet unlocked successfully', 'success');
                
            } catch (error) {
                showError('Invalid password or corrupted wallet data');
            }
        }

        function showCreateNewWallet() {
            document.getElementById('loginForm').style.display = 'none';
            document.getElementById('createWalletForm').style.display = 'block';
        }

        function showImportWallet() {
            document.getElementById('loginForm').style.display = 'none';
            document.getElementById('importWalletForm').style.display = 'block';
        }

        function backToLogin() {
            document.getElementById('loginForm').style.display = 'block';
            document.getElementById('createWalletForm').style.display = 'none';
            document.getElementById('importWalletForm').style.display = 'none';
            
            // Reset to first tab
            const firstTab = document.querySelector('#importWalletForm .tab');
            if (firstTab) {
                firstTab.click();
            }
            
            // Hide 2FA fields
            document.getElementById('importCode2FAField').style.display = 'none';
            document.getElementById('importSeed2FAField').style.display = 'none';
            
            // Clear all fields
            for (let i = 1; i <= 6; i++) {
                if (document.getElementById(`code${i}`)) {
                    document.getElementById(`code${i}`).value = '';
                }
            }
        }

        function createNewWallet() {
            const password = document.getElementById('newPassword').value;
            const confirmPass = document.getElementById('confirmPassword').value;
            
            if (password.length < 8) {
                showError('Password must be at least 8 characters');
                return;
            }
            
            if (password !== confirmPass) {
                showError('Passwords do not match');
                return;
            }
            
            // Generate seed phrase
            const seedPhrase = generateSeedPhrase();
            
            // Create wallet
            walletState = {
                address: 'QRC' + generateRandomString(32),
                seedPhrase: seedPhrase,
                balance: 1000,
                transactions: [],
                created: Date.now()
            };
            
            // Encrypt and save
            const encrypted = CryptoJS.AES.encrypt(JSON.stringify(walletState), password).toString();
            localStorage.setItem('qrcWalletEncrypted', encrypted);
            
            showSuccess('Wallet created successfully! Please login.');
            setTimeout(() => {
                backToLogin();
                document.getElementById('newPassword').value = '';
                document.getElementById('confirmPassword').value = '';
            }, 2000);
        }

        function importExistingWallet() {
            // This is now replaced by importWithSeedPhrase
            importWithSeedPhrase();
        }
        
        function showImportTab(tabName, element) {
            // Update tab styles
            document.querySelectorAll('#importWalletForm .tab').forEach(tab => {
                tab.classList.remove('active');
            });
            element.classList.add('active');
            
            // Hide all import tabs
            document.querySelectorAll('.import-tab-content').forEach(content => {
                content.style.display = 'none';
            });
            
            // Show selected tab
            if (tabName === 'code') {
                document.getElementById('importCodeTab').style.display = 'block';
            } else {
                document.getElementById('importSeedTab').style.display = 'block';
            }
        }

        function moveToNextSeed(current, currentIndex) {
            // Auto-advance on space or when word looks complete
            if (current.value.includes(' ') || (current.value.length > 3 && event.inputType !== 'deleteContentBackward')) {
                current.value = current.value.trim();
                if (currentIndex < 24) {
                    document.getElementById(`seed${currentIndex + 1}`).focus();
                }
            }
            
            // Handle backspace
            if (current.value.length === 0 && event.inputType === 'deleteContentBackward' && currentIndex > 1) {
                document.getElementById(`seed${currentIndex - 1}`).focus();
            }
        }

        function importWithCode() {
            const importCode = document.getElementById('importCode').value;
            const password = document.getElementById('importCodePassword').value;
            
            if (!importCode) {
                showError('Please enter your import code');
                return;
            }
            
            if (password.length < 8) {
                showError('Password must be at least 8 characters');
                return;
            }
            
            // Check if 2FA is needed
            if (document.getElementById('importCode2FAField').style.display === 'none') {
                document.getElementById('importCode2FAField').style.display = 'block';
                document.getElementById('importCode1').focus();
                return;
            }
            
            // Get 2FA code
            let twoFACode = '';
            for (let i = 1; i <= 6; i++) {
                twoFACode += document.getElementById(`importCode${i}`).value;
            }
            
            if (twoFACode.length !== 6) {
                showError('Please enter the complete 6-digit Google Authenticator code');
                return;
            }
            
            // Process import with code
            walletState = {
                address: 'QRC' + generateAddressFromCode(importCode),
                seedPhrase: ['imported', 'with', 'code'],
                balance: 0,
                transactions: [],
                imported: Date.now(),
                importMethod: 'code'
            };
            
            // Encrypt and save
            const encrypted = CryptoJS.AES.encrypt(JSON.stringify(walletState), password).toString();
            localStorage.setItem('qrcWalletEncrypted', encrypted);
            
            showSuccess('Wallet imported successfully! Please login.');
            setTimeout(() => {
                backToLogin();
                document.getElementById('importCode').value = '';
                document.getElementById('importCodePassword').value = '';
                for (let i = 1; i <= 6; i++) {
                    document.getElementById(`importCode${i}`).value = '';
                }
            }, 2000);
        }

        function importWithSeedPhrase() {
            // Collect seed phrase from 24 inputs
            const seedWords = [];
            for (let i = 1; i <= 24; i++) {
                const word = document.getElementById(`seed${i}`).value.trim().toLowerCase();
                if (!word) {
                    showError(`Please enter word ${i} of your seed phrase`);
                    document.getElementById(`seed${i}`).focus();
                    return;
                }
                seedWords.push(word);
            }
            
            const password = document.getElementById('importSeedPassword').value;
            
            if (password.length < 8) {
                showError('Password must be at least 8 characters');
                return;
            }
            
            // Show 2FA field if not shown
            if (document.getElementById('importSeed2FAField').style.display === 'none') {
                document.getElementById('importSeed2FAField').style.display = 'block';
                document.getElementById('importSeedCode1').focus();
                showNotification('Enter Google Authenticator code if enabled on this wallet', 'info');
                return;
            }
            
            // Get 2FA code (optional for seed import)
            let twoFACode = '';
            for (let i = 1; i <= 6; i++) {
                twoFACode += document.getElementById(`importSeedCode${i}`).value;
            }
            
            // Import wallet
            walletState = {
                address: 'QRC' + generateAddressFromSeed(seedWords.join(' ')),
                seedPhrase: seedWords,
                balance: 0,
                transactions: [],
                imported: Date.now(),
                importMethod: 'seed'
            };
            
            // Encrypt and save
            const encrypted = CryptoJS.AES.encrypt(JSON.stringify(walletState), password).toString();
            localStorage.setItem('qrcWalletEncrypted', encrypted);
            
            showSuccess('Wallet imported successfully! Please login.');
            setTimeout(() => {
                backToLogin();
                for (let i = 1; i <= 24; i++) {
                    document.getElementById(`seed${i}`).value = '';
                }
                document.getElementById('importSeedPassword').value = '';
                for (let i = 1; i <= 6; i++) {
                    document.getElementById(`importSeedCode${i}`).value = '';
                }
            }, 2000);
        }

        function generateAddressFromCode(code) {
            // Generate address from import code
            let hash = 0;
            for (let i = 0; i < code.length; i++) {
                hash = ((hash << 5) - hash) + code.charCodeAt(i);
                hash = hash & hash;
            }
            return Math.abs(hash).toString(36).toUpperCase().padEnd(32, '0').substring(0, 32);
        }

        function logout() {
            if (confirm('Are you sure you want to logout?')) {
                walletState = {
                    address: null,
                    seedPhrase: null,
                    balance: 0,
                    isLoggedIn: false,
                    transactions: []
                };
                sessionPassword = null;
                
                // Show login screen
                document.getElementById('appContainer').style.display = 'none';
                document.getElementById('loginScreen').style.display = 'block';
                document.getElementById('walletPassword').value = '';
                
                showNotification('Logged out successfully', 'info');
            }
        }

        // App initialization
        function initializeApp() {
            // Update UI with wallet info
            document.getElementById('walletAddress').textContent = walletState.address;
            document.getElementById('userAvatar').textContent = walletState.address.substring(3, 4).toUpperCase();
            document.getElementById('userDisplay').textContent = walletState.address.substring(0, 8) + '...';
            
            // Update balance
            updateBalanceDisplay();
            
            // Start real-time updates
            startRealtimeUpdates();
            
            // Load initial data
            updateStats();
            loadTransactionHistory();
        }

        function startRealtimeUpdates() {
            // Update balance every 5 seconds
            setInterval(() => {
                updateBalance();
            }, 5000);
            
            // Update stats every 3 seconds
            setInterval(() => {
                updateStats();
            }, 3000);
        }

        // Wallet functions
        function generateSeedPhrase() {
            const words = ['abandon', 'ability', 'able', 'about', 'above', 'absent', 'absorb', 'abstract', 
                          'absurd', 'abuse', 'access', 'accident', 'account', 'accuse', 'achieve', 'acid',
                          'acoustic', 'acquire', 'across', 'act', 'action', 'actor', 'actress', 'actual'];
            const phrase = [];
            for (let i = 0; i < 24; i++) {
                phrase.push(words[Math.floor(Math.random() * words.length)]);
            }
            return phrase;
        }

        function generateRandomString(length) {
            const chars = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ';
            let result = '';
            for (let i = 0; i < length; i++) {
                result += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return result;
        }

        function generateAddressFromSeed(seed) {
            // Simple hash of seed for demo
            let hash = 0;
            for (let i = 0; i < seed.length; i++) {
                hash = ((hash << 5) - hash) + seed.charCodeAt(i);
                hash = hash & hash;
            }
            return Math.abs(hash).toString(36).toUpperCase().padEnd(32, '0').substring(0, 32);
        }

        function updateBalanceDisplay() {
            document.getElementById('balanceAmount').textContent = `${walletState.balance.toFixed(2)} QRC`;
            document.getElementById('balanceUSD').textContent = `≈ ${(walletState.balance * 0.001).toFixed(2)} USD`;
        }

        function updateBalance() {
            // In real app, fetch from blockchain
            fetch(`/api/wallet/balance/${walletState.address}`)
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        walletState.balance = data.balance;
                        updateBalanceDisplay();
                    }
                })
                .catch(() => {
                    // Handle offline mode
                });
        }

        function updateStats() {
            // Simulate stats
            document.getElementById('currentTPS').textContent = Math.floor(Math.random() * 1000 + 773);
            document.getElementById('totalBlocks').textContent = (parseInt(document.getElementById('totalBlocks').textContent) + 1).toLocaleString();
            document.getElementById('totalTransactions').textContent = (parseInt(document.getElementById('totalTransactions').textContent.replace(/,/g, '')) + Math.floor(Math.random() * 10)).toLocaleString();
            document.getElementById('activeUsers').textContent = Math.floor(Math.random() * 500 + 1000).toLocaleString();
        }

        function showTab(tabName, element) {
            // Update tab styles
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            element.classList.add('active');
            
            // Update content
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById(tabName + 'Tab').classList.add('active');
        }

        function loadTransactionHistory() {
            const container = document.getElementById('transactionHistory');
            
            if (walletState.transactions.length === 0) {
                return;
            }
            
            container.innerHTML = walletState.transactions.map(tx => {
                const isReceived = tx.type === 'received';
                return `
                    <div class="transaction-item">
                        <div class="transaction-icon ${isReceived ? 'received' : 'sent'}">
                            ${isReceived ? '📥' : '📤'}
                        </div>
                        <div class="transaction-details">
                            <div class="transaction-type">${isReceived ? 'Received' : 'Sent'}</div>
                            <div class="transaction-address">${isReceived ? tx.from : tx.to}</div>
                            <div class="transaction-time">${formatTime(new Date(tx.timestamp))}</div>
                        </div>
                        <div class="transaction-amount">
                            <div class="transaction-value ${isReceived ? 'positive' : 'negative'}">
                                ${isReceived ? '+' : '-'}${tx.amount} QRC
                            </div>
                            <div class="transaction-usd">≈ ${(tx.amount * 0.001).toFixed(2)} USD</div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function formatTime(date) {
            const now = new Date();
            const diff = now - date;
            
            if (diff < 60000) return 'Just now';
            if (diff < 3600000) return Math.floor(diff / 60000) + ' min ago';
            if (diff < 86400000) return Math.floor(diff / 3600000) + ' hours ago';
            
            return date.toLocaleDateString();
        }

        // Faucet function
        async function getFaucet() {
            try {
                const response = await fetch('/api/faucet/claim', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        address: walletState.address
                    })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    walletState.balance += 100;
                    updateBalanceDisplay();
                    showNotification('100 Test QRC received!', 'success');
                    
                    // Add to transaction history
                    walletState.transactions.unshift({
                        type: 'received',
                        from: 'Faucet',
                        amount: 100,
                        timestamp: Date.now()
                    });
                    
                    loadTransactionHistory();
                } else {
                    showNotification(data.error || 'Faucet claim failed', 'error');
                }
            } catch (error) {
                showNotification('Failed to connect to faucet', 'error');
            }
        }

        // Send transaction
        function showSendModal() {
            document.getElementById('sendModal').style.display = 'flex';
            updateFeeDisplay();
        }

        function updateFeeDisplay() {
            const amount = parseFloat(document.getElementById('sendAmount').value) || 0;
            const fee = Math.max(amount * 0.002, 0.01);
            document.getElementById('feeDisplay').textContent = fee.toFixed(2) + ' QRC';
            document.getElementById('totalDisplay').textContent = (amount + fee).toFixed(2) + ' QRC';
        }

        function confirmSend() {
            const recipient = document.getElementById('recipientAddress').value;
            const amount = parseFloat(document.getElementById('sendAmount').value);
            const password = document.getElementById('sendPassword').value;
            
            if (!recipient || !amount || !password) {
                showNotification('Please fill in all fields', 'error');
                return;
            }
            
            if (password !== sessionPassword) {
                showNotification('Invalid password', 'error');
                return;
            }
            
            if (!recipient.startsWith('QRC')) {
                showNotification('Invalid address format', 'error');
                return;
            }
            
            const fee = Math.max(amount * 0.002, 0.01);
            const total = amount + fee;
            
            if (total > walletState.balance) {
                showNotification('Insufficient balance', 'error');
                return;
            }
            
            // Process transaction
            walletState.balance -= total;
            updateBalanceDisplay();
            
            // Add to transaction history
            walletState.transactions.unshift({
                type: 'sent',
                to: recipient,
                amount: amount,
                fee: fee,
                timestamp: Date.now()
            });
            
            loadTransactionHistory();
            
            // Save updated state
            const encrypted = CryptoJS.AES.encrypt(JSON.stringify(walletState), sessionPassword).toString();
            localStorage.setItem('qrcWalletEncrypted', encrypted);
            
            showNotification('Transaction sent successfully!', 'success');
            closeModal('sendModal');
            
            // Clear form
            document.getElementById('recipientAddress').value = '';
            document.getElementById('sendAmount').value = '';
            document.getElementById('sendPassword').value = '';
        }

        // Receive functions
        function showReceiveModal() {
            const modal = document.getElementById('receiveModal');
            modal.style.display = 'flex';
            
            // Generate QR code
            if (receiveQrcode) {
                document.getElementById('receiveQrcode').innerHTML = '';
            }
            
            receiveQrcode = new QRCode(document.getElementById('receiveQrcode'), {
                text: walletState.address,
                width: 200,
                height: 200,
                colorDark: '#000000',
                colorLight: '#ffffff',
                correctLevel: QRCode.CorrectLevel.H
            });
            
            document.getElementById('receiveAddress').textContent = walletState.address;
        }

        function showQRModal() {
            const modal = document.getElementById('qrModal');
            modal.style.display = 'flex';
            
            if (qrcode) {
                document.getElementById('qrcode').innerHTML = '';
            }
            
            qrcode = new QRCode(document.getElementById('qrcode'), {
                text: walletState.address,
                width: 200,
                height: 200,
                colorDark: '#000000',
                colorLight: '#ffffff',
                correctLevel: QRCode.CorrectLevel.H
            });
            
            document.getElementById('qrAddress').textContent = walletState.address;
        }

        function copyAddress() {
            navigator.clipboard.writeText(walletState.address);
            showNotification('Address copied to clipboard!', 'success');
        }

        // Check for existing session on load
        window.onload = function() {
            const hasWallet = localStorage.getItem('qrcWalletEncrypted');
            if (!hasWallet) {
                showNotification('Welcome! Create a new wallet to get started.', 'info');
            }
        };
    </script>
</body>
</html>
