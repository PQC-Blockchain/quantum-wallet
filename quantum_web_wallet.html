<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QRC Wallet - Quantum Resistant Blockchain</title>
    <link rel="icon" type="image/x-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' fill='%2300ff88' rx='20'/></svg>">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
            background: linear-gradient(135deg, #0f0f23 0%, #1a1a3e 100%);
            color: #ffffff;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }

        /* Login Screen Styles */
        .login-container {
            width: 100%;
            max-width: 400px;
            background: rgba(255, 255, 255, 0.05);
            padding: 40px;
            border-radius: 24px;
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            margin-top: 100px;
        }

        .login-logo { text-align: center; margin-bottom: 30px; }
        
        .login-logo .logo {
            width: 80px;
            height: 80px;
            background: #00ff88;
            border-radius: 20px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-size: 36px;
            font-weight: bold;
            color: #000;
            margin-bottom: 20px;
        }
        
        .login-title { font-size: 24px; text-align: center; margin-bottom: 10px; }
        .login-subtitle { color: #999; text-align: center; margin-bottom: 30px; }
        
        .input-group { margin-bottom: 20px; }
        .input-label { display: block; margin-bottom: 8px; color: #999; font-size: 14px; }
        
        .input-field {
            width: 100%;
            padding: 15px;
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.05);
            color: white;
            font-size: 16px;
            transition: all 0.3s;
            /* Disable browser autocomplete */
            autocomplete: off;
            -webkit-autocomplete: off;
        }
        
        .input-field:focus {
            outline: none;
            border-color: #00ff88;
            background: rgba(255, 255, 255, 0.08);
        }
        
        .password-toggle { position: relative; }
        
        .password-toggle-btn {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: #999;
            cursor: pointer;
            font-size: 20px;
        }
        
        /* 6-digit code input style */
        .code-input-container {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-bottom: 20px;
        }
        
        .code-input {
            width: 45px;
            height: 55px;
            text-align: center;
            font-size: 24px;
            font-weight: bold;
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.05);
            color: #00ff88;
            transition: all 0.3s;
            /* Disable autocomplete */
            autocomplete: off;
            -webkit-autocomplete: off;
        }
        
        .code-input:focus {
            outline: none;
            border-color: #00ff88;
            background: rgba(0, 255, 136, 0.1);
            box-shadow: 0 0 0 3px rgba(0, 255, 136, 0.2);
        }
        
        .code-input:disabled {
            background: rgba(255, 255, 255, 0.02);
            border-color: rgba(255, 255, 255, 0.1);
            color: #666;
        }
        
        .error-message {
            background: rgba(255, 107, 107, 0.1);
            border: 1px solid #ff6b6b;
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-size: 14px;
            display: none;
        }
        
        .success-message {
            background: rgba(0, 255, 136, 0.1);
            border: 1px solid #00ff88;
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-size: 14px;
            display: none;
        }

        /* Main App Styles */
        .app-container {
            width: 100%;
            max-width: 1400px;
            display: none;
        }

        .main-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 40px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 16px;
            backdrop-filter: blur(10px);
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo {
            width: 50px;
            height: 50px;
            background: #00ff88;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: bold;
            color: #000;
        }

        .wallet-info h1 {
            font-size: 20px;
            margin-bottom: 5px;
        }

        .wallet-address-display {
            font-size: 14px;
            color: #999;
            font-family: monospace;
        }

        .nav-links {
            display: flex;
            gap: 20px;
            list-style: none;
        }

        .nav-link {
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .nav-link:hover, .nav-link.active {
            background: rgba(0, 255, 136, 0.1);
            border-color: #00ff88;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 350px;
            gap: 30px;
        }

        .wallet-section {
            background: rgba(255, 255, 255, 0.05);
            padding: 30px;
            border-radius: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .balance-section {
            text-align: center;
            margin-bottom: 40px;
        }

        .balance-label {
            color: #999;
            font-size: 14px;
            margin-bottom: 10px;
        }

        .balance-amount {
            font-size: 48px;
            font-weight: bold;
            background: linear-gradient(135deg, #00ff88 0%, #00ccff 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 5px;
        }

        .balance-usd {
            color: #666;
            font-size: 18px;
        }

        .wallet-actions {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 30px;
        }

        .action-button {
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            color: white;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
        }

        .action-button:hover {
            background: rgba(0, 255, 136, 0.1);
            border-color: #00ff88;
            transform: translateY(-2px);
        }

        .action-icon {
            font-size: 24px;
        }

        .stats-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.03);
            padding: 20px;
            border-radius: 12px;
            text-align: center;
        }

        .stat-label {
            color: #666;
            font-size: 12px;
            margin-bottom: 5px;
        }

        .stat-value {
            font-size: 24px;
            font-weight: bold;
            color: #00ff88;
        }

        .recent-activity {
            background: rgba(255, 255, 255, 0.03);
            padding: 20px;
            border-radius: 12px;
        }

        .activity-header {
            font-size: 16px;
            margin-bottom: 15px;
            color: #999;
        }

        .transaction-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .transaction-item {
            background: rgba(255, 255, 255, 0.03);
            padding: 15px;
            border-radius: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .transaction-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .transaction-icon {
            width: 36px;
            height: 36px;
            background: rgba(0, 255, 136, 0.1);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
        }

        .transaction-details h4 {
            font-size: 14px;
            margin-bottom: 2px;
        }

        .transaction-address {
            font-size: 12px;
            color: #666;
        }

        .transaction-amount {
            text-align: right;
        }

        .amount-positive {
            color: #00ff88;
        }

        .amount-negative {
            color: #ff6b6b;
        }

        .sidebar {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .security-status {
            background: rgba(255, 255, 255, 0.05);
            padding: 25px;
            border-radius: 16px;
            text-align: center;
        }

        .security-icon {
            font-size: 48px;
            margin-bottom: 15px;
        }

        .security-title {
            font-size: 18px;
            margin-bottom: 10px;
        }

        .security-features {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 20px;
        }

        .security-feature {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 8px;
            font-size: 14px;
        }

        .feature-enabled {
            color: #00ff88;
        }

        .feature-disabled {
            color: #666;
        }

        .quick-actions {
            background: rgba(255, 255, 255, 0.05);
            padding: 25px;
            border-radius: 16px;
        }

        .quick-actions h3 {
            font-size: 16px;
            margin-bottom: 15px;
            color: #999;
        }

        .quick-action-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .quick-action-btn {
            padding: 12px;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            color: white;
            cursor: pointer;
            transition: all 0.3s;
            text-align: left;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .quick-action-btn:hover {
            background: rgba(0, 255, 136, 0.1);
            border-color: #00ff88;
        }

        /* Tab Content */
        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Modals */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: #1a1a3e;
            padding: 30px;
            border-radius: 20px;
            max-width: 500px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .modal-title {
            font-size: 24px;
        }

        .close-modal {
            background: none;
            border: none;
            color: #999;
            font-size: 28px;
            cursor: pointer;
            transition: color 0.3s;
        }

        .close-modal:hover {
            color: #fff;
        }

        /* Forms */
        .form-group {
            margin-bottom: 20px;
        }

        .button {
            padding: 15px 30px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            justify-content: center;
            width: 100%;
        }

        .button-primary {
            background: linear-gradient(135deg, #00ff88 0%, #00cc66 100%);
            color: #000;
        }

        .button-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(0, 255, 136, 0.3);
        }

        .button-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .button-secondary:hover {
            background: rgba(255, 255, 255, 0.15);
            border-color: rgba(255, 255, 255, 0.3);
        }

        /* Notifications */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            background: #1a1a3e;
            border: 1px solid #00ff88;
            border-radius: 8px;
            color: #00ff88;
            display: none;
            z-index: 2000;
            animation: slideIn 0.3s ease-out;
        }

        .notification.error {
            border-color: #ff6b6b;
            color: #ff6b6b;
        }

        /* Security Tab Content */
        .security-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .security-card {
            background: rgba(255, 255, 255, 0.05);
            padding: 25px;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .security-card h3 {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
            font-size: 18px;
        }

        .security-card p {
            color: #999;
            font-size: 14px;
            margin-bottom: 20px;
            line-height: 1.6;
        }

        .status-indicator {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .status-enabled {
            background: rgba(0, 255, 136, 0.1);
            color: #00ff88;
            border: 1px solid rgba(0, 255, 136, 0.3);
        }

        .status-disabled {
            background: rgba(255, 107, 107, 0.1);
            color: #ff6b6b;
            border: 1px solid rgba(255, 107, 107, 0.3);
        }

        /* Google Authenticator Setup */
        .two-factor-setup {
            text-align: center;
        }

        .qr-code-2fa {
            background: white;
            padding: 20px;
            border-radius: 12px;
            display: inline-block;
            margin: 20px 0;
        }

        .manual-code {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 8px;
            font-family: monospace;
            font-size: 18px;
            letter-spacing: 2px;
            color: #00ff88;
            margin: 20px 0;
            word-break: break-all;
        }

        /* Wallet Connect Buttons */
        .wallet-connect-btn {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 15px 20px;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            color: white;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 16px;
            width: 100%;
            margin-bottom: 10px;
        }

        .wallet-connect-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: rgba(255, 255, 255, 0.2);
            transform: translateX(5px);
        }

        /* Import Wallet Special Styles */
        .import-section {
            margin-bottom: 30px;
        }

        .import-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .import-tab {
            padding: 10px 20px;
            background: none;
            border: none;
            color: #999;
            cursor: pointer;
            transition: all 0.3s;
            border-bottom: 2px solid transparent;
        }

        .import-tab.active {
            color: #00ff88;
            border-bottom-color: #00ff88;
        }

        .divider {
            text-align: center;
            margin: 20px 0;
            position: relative;
        }

        .divider::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 1px;
            background: rgba(255, 255, 255, 0.1);
        }

        .divider span {
            background: #1a1a3e;
            padding: 0 15px;
            position: relative;
            color: #666;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.2); opacity: 0.8; }
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateX(100px); }
            to { opacity: 1; transform: translateX(0); }
        }

        @media (max-width: 968px) {
            .main-content { grid-template-columns: 1fr; }
            .main-header { flex-direction: column; gap: 20px; }
            .nav-links { flex-wrap: wrap; justify-content: center; }
        }

        @media (max-width: 768px) {
            .stats-section { grid-template-columns: 1fr; }
            .wallet-section { padding: 24px; }
            .balance-amount { font-size: 36px; }
            .transaction-item { flex-direction: column; align-items: flex-start; gap: 10px; }
            .transaction-amount { align-self: flex-end; }
            .security-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <!-- Login Screen -->
    <div class="login-container" id="loginScreen">
        <div class="login-logo">
            <div class="logo">QRC</div>
        </div>
        <h1 class="login-title">Quantum Wallet</h1>
        <p class="login-subtitle">Secure access to your quantum-resistant blockchain</p>
        
        <div class="error-message" id="loginError"></div>
        <div class="success-message" id="loginSuccess"></div>

        <div id="loginForm">
            <div class="input-group">
                <label class="input-label">Wallet Password</label>
                <div class="password-toggle">
                    <input type="password" class="input-field" id="walletPassword" 
                           placeholder="Enter your secure password" 
                           autocomplete="off"
                           data-lpignore="true"
                           data-form-type="other">
                    <button class="password-toggle-btn" onclick="togglePassword('walletPassword')">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/>
                        </svg>
                    </button>
                </div>
            </div>
            
            <div class="input-group" id="login2FAField" style="display: none;">
                <label class="input-label">Google Authenticator Code</label>
                <div class="code-input-container" id="loginCodeContainer">
                    <input type="text" class="code-input" maxlength="1" data-index="0" autocomplete="off">
                    <input type="text" class="code-input" maxlength="1" data-index="1" autocomplete="off">
                    <input type="text" class="code-input" maxlength="1" data-index="2" autocomplete="off">
                    <input type="text" class="code-input" maxlength="1" data-index="3" autocomplete="off">
                    <input type="text" class="code-input" maxlength="1" data-index="4" autocomplete="off">
                    <input type="text" class="code-input" maxlength="1" data-index="5" autocomplete="off">
                </div>
            </div>
            
            <button class="button button-primary" onclick="attemptLogin()">
                <span>🔐</span>
                <span>Unlock Wallet</span>
            </button>
            
            <button class="button button-secondary" onclick="showCreateNewWallet()">
                <span>✨</span>
                <span>Create New Wallet</span>
            </button>
            
            <button class="button button-secondary" onclick="showImportWallet()">
                <span>📥</span>
                <span>Import Existing Wallet</span>
            </button>
        </div>
        
        <div id="createWalletForm" style="display: none;">
            <div class="input-group">
                <label class="input-label">Create Password (min 8 characters)</label>
                <div class="password-toggle">
                    <input type="password" class="input-field" id="newPassword" 
                           placeholder="Create a strong password" 
                           autocomplete="new-password"
                           data-lpignore="true">
                    <button class="password-toggle-btn" onclick="togglePassword('newPassword')">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/>
                        </svg>
                    </button>
                </div>
            </div>
            
            <div class="input-group">
                <label class="input-label">Confirm Password</label>
                <div class="password-toggle">
                    <input type="password" class="input-field" id="confirmPassword" 
                           placeholder="Confirm your password" 
                           autocomplete="new-password"
                           data-lpignore="true">
                    <button class="password-toggle-btn" onclick="togglePassword('confirmPassword')">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/>
                        </svg>
                    </button>
                </div>
            </div>
            
            <button class="button button-primary" onclick="createNewWallet()">
                <span>🚀</span>
                <span>Create Secure Wallet</span>
            </button>
            
            <button class="button button-secondary" onclick="backToLogin()">
                <span>←</span>
                <span>Back to Login</span>
            </button>
        </div>
        
        <div id="importWalletForm" style="display: none;">
            <div style="margin-bottom: 20px;">
                <p style="color: #999; text-align: center; margin-bottom: 20px;">Import your founder wallet</p>
                
                <div class="input-group">
                    <label class="input-label">Wallet Address</label>
                    <input type="text" class="input-field" id="importAddress" 
                           placeholder="QRC..." 
                           autocomplete="off"
                           data-lpignore="true"
                           data-form-type="other">
                </div>
                
                <div class="input-group">
                    <label class="input-label">Password</label>
                    <div class="password-toggle">
                        <input type="password" class="input-field" id="importPassword" 
                               placeholder="Enter your password" 
                               autocomplete="off"
                               data-lpignore="true"
                               data-form-type="other">
                        <button class="password-toggle-btn" onclick="togglePassword('importPassword')">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/>
                            </svg>
                        </button>
                    </div>
                </div>
                
                <div class="input-group" id="import2FAField">
                    <label class="input-label">Google Authenticator Code</label>
                    <div class="code-input-container" id="importCodeContainer">
                        <input type="text" class="code-input" maxlength="1" data-index="0" autocomplete="off">
                        <input type="text" class="code-input" maxlength="1" data-index="1" autocomplete="off">
                        <input type="text" class="code-input" maxlength="1" data-index="2" autocomplete="off">
                        <input type="text" class="code-input" maxlength="1" data-index="3" autocomplete="off">
                        <input type="text" class="code-input" maxlength="1" data-index="4" autocomplete="off">
                        <input type="text" class="code-input" maxlength="1" data-index="5" autocomplete="off">
                    </div>
                </div>
                
                <button class="button button-primary" onclick="importWallet()">
                    <span>🔓</span>
                    <span>Import Wallet</span>
                </button>
            </div>
            
            <button class="button button-secondary" onclick="backToLogin()">
                <span>←</span>
                <span>Back to Login</span>
            </button>
        </div>
    </div>

    <!-- Main App -->
    <div class="app-container" id="appContainer">
        <header class="main-header">
            <div class="logo-section">
                <div class="logo">QRC</div>
                <div class="wallet-info">
                    <h1>Quantum Wallet</h1>
                    <div class="wallet-address-display" id="walletAddress">Loading...</div>
                </div>
            </div>
            
            <nav>
                <ul class="nav-links">
                    <li class="nav-link active" onclick="showTab('wallet')" data-tab="wallet">💰 Wallet</li>
                    <li class="nav-link" onclick="showTab('send')" data-tab="send">📤 Send</li>
                    <li class="nav-link" onclick="showTab('receive')" data-tab="receive">📥 Receive</li>
                    <li class="nav-link" onclick="showTab('activity')" data-tab="activity">📊 Activity</li>
                    <li class="nav-link" onclick="showTab('security')" data-tab="security">🔒 Security</li>
                    <li class="nav-link" onclick="showTab('settings')" data-tab="settings">⚙️ Settings</li>
                    <li class="nav-link" onclick="logout()" style="background: rgba(255, 107, 107, 0.1); border-color: rgba(255, 107, 107, 0.3);">🚪 Logout</li>
                </ul>
            </nav>
        </header>

        <div class="main-content">
            <!-- Wallet Tab -->
            <div class="tab-content active" id="walletTab">
                <div class="wallet-section">
                    <div class="balance-section">
                        <div class="balance-label">Total Balance</div>
                        <div class="balance-amount" id="balance">0.00 QRC</div>
                        <div class="balance-usd">≈ $0.00 USD</div>
                    </div>
                    
                    <div class="wallet-actions">
                        <button class="action-button" onclick="showTab('send')">
                            <span class="action-icon">📤</span>
                            <span>Send</span>
                        </button>
                        <button class="action-button" onclick="showTab('receive')">
                            <span class="action-icon">📥</span>
                            <span>Receive</span>
                        </button>
                    </div>
                    
                    <div class="stats-section">
                        <div class="stat-card">
                            <div class="stat-label">Network TPS</div>
                            <div class="stat-value" id="tps">0</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">Block Height</div>
                            <div class="stat-value" id="blocks">0</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">Total Transactions</div>
                            <div class="stat-value" id="transactions">0</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">Active Users</div>
                            <div class="stat-value" id="users">0</div>
                        </div>
                    </div>
                    
                    <div class="recent-activity">
                        <h3 class="activity-header">Recent Activity</h3>
                        <div class="transaction-list" id="recentTransactions">
                            <p style="color: #666; text-align: center;">No transactions yet</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Security Tab -->
            <div class="tab-content" id="securityTab">
                <div class="wallet-section">
                    <h2 style="margin-bottom: 30px;">🔒 Security Settings</h2>
                    
                    <div class="security-grid">
                        <div class="security-card">
                            <h3>
                                <span>🔐</span>
                                <span>Google Authenticator</span>
                            </h3>
                            <p>Add an extra layer of security with Google Authenticator app</p>
                            <div style="margin-bottom: 15px;">
                                <span class="status-indicator status-disabled" id="twoFactorStatus">
                                    <span>●</span>
                                    <span>Disabled</span>
                                </span>
                            </div>
                            <button class="button button-secondary" onclick="showTwoFactorModal()">
                                Setup Google Authenticator
                            </button>
                        </div>
                        
                        <div class="security-card">
                            <h3>
                                <span>🔑</span>
                                <span>Change Password</span>
                            </h3>
                            <p>Regularly update your password to maintain security</p>
                            <button class="button button-secondary" onclick="showChangePasswordModal()">
                                Change Password
                            </button>
                        </div>
                        
                        <div class="security-card">
                            <h3>
                                <span>📝</span>
                                <span>Backup Seed Phrase</span>
                            </h3>
                            <p>View and backup your 24-word recovery phrase</p>
                            <button class="button button-secondary" onclick="showSeedPhraseModal()">
                                View Seed Phrase
                            </button>
                        </div>
                        
                        <div class="security-card">
                            <h3>
                                <span>🔒</span>
                                <span>Export Private Key</span>
                            </h3>
                            <p>Export your private key for external use</p>
                            <button class="button button-secondary" onclick="showExportPrivateKeyModal()">
                                Export Private Key
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="sidebar">
                <div class="security-status">
                    <div class="security-icon">🛡️</div>
                    <h3 class="security-title">Security Status</h3>
                    <p style="color: #999; font-size: 14px;" id="securityStatusText">Your wallet is protected</p>
                    
                    <div class="security-features">
                        <div class="security-feature feature-enabled">
                            <span>✓</span>
                            <span>Password Protection</span>
                        </div>
                        <div class="security-feature feature-disabled" id="twoFactorFeature">
                            <span>○</span>
                            <span>Google Authenticator</span>
                        </div>
                        <div class="security-feature feature-enabled">
                            <span>✓</span>
                            <span>Encrypted Storage</span>
                        </div>
                        <div class="security-feature feature-enabled">
                            <span>✓</span>
                            <span>Quantum Resistant</span>
                        </div>
                    </div>
                </div>
                
                <div class="quick-actions">
                    <h3>Quick Actions</h3>
                    <div class="quick-action-list">
                        <button class="quick-action-btn" onclick="showQRCode()">
                            <span>📱</span>
                            <span>Show QR Code</span>
                        </button>
                        <button class="quick-action-btn" onclick="copyAddress()">
                            <span>📋</span>
                            <span>Copy Address</span>
                        </button>
                        <button class="quick-action-btn" onclick="refreshWallet()">
                            <span>🔄</span>
                            <span>Refresh Balance</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modals -->
    <!-- Google Authenticator Setup Modal -->
    <div class="modal" id="twoFactorModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">🔐 Setup Google Authenticator</h2>
                <button class="close-modal" onclick="closeModal('twoFactorModal')">×</button>
            </div>
            <div class="two-factor-setup">
                <p>Scan this QR code with Google Authenticator app:</p>
                <div class="qr-code-2fa" id="qrCodeContainer">
                    <!-- QR Code will be generated here -->
                </div>
                <p>Or enter this code manually:</p>
                <div class="manual-code" id="manualCode">
                    <!-- Manual code will be displayed here -->
                </div>
                <div class="input-group">
                    <label class="input-label">Enter 6-digit code from Google Authenticator:</label>
                    <div class="code-input-container" id="verify2FAContainer">
                        <input type="text" class="code-input" maxlength="1" data-index="0" autocomplete="off">
                        <input type="text" class="code-input" maxlength="1" data-index="1" autocomplete="off">
                        <input type="text" class="code-input" maxlength="1" data-index="2" autocomplete="off">
                        <input type="text" class="code-input" maxlength="1" data-index="3" autocomplete="off">
                        <input type="text" class="code-input" maxlength="1" data-index="4" autocomplete="off">
                        <input type="text" class="code-input" maxlength="1" data-index="5" autocomplete="off">
                    </div>
                </div>
                <button class="button button-primary" onclick="verify2FA()">Verify & Enable Google Authenticator</button>
            </div>
        </div>
    </div>

    <!-- Change Password Modal -->
    <div class="modal" id="changePasswordModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">🔒 Change Password</h2>
                <button class="close-modal" onclick="closeModal('changePasswordModal')">×</button>
            </div>
            <div class="input-group">
                <label class="input-label">Current Password:</label>
                <div class="password-toggle">
                    <input type="password" class="input-field" id="currentPassword" 
                           placeholder="Enter current password" 
                           autocomplete="off"
                           data-lpignore="true">
                    <button class="password-toggle-btn" onclick="togglePassword('currentPassword')">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/>
                        </svg>
                    </button>
                </div>
            </div>
            <div class="input-group">
                <label class="input-label">New Password:</label>
                <div class="password-toggle">
                    <input type="password" class="input-field" id="newPasswordChange" 
                           placeholder="Enter new password" 
                           autocomplete="new-password"
                           data-lpignore="true">
                    <button class="password-toggle-btn" onclick="togglePassword('newPasswordChange')">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/>
                        </svg>
                    </button>
                </div>
            </div>
            <div class="input-group">
                <label class="input-label">Confirm New Password:</label>
                <div class="password-toggle">
                    <input type="password" class="input-field" id="confirmPasswordChange" 
                           placeholder="Confirm new password" 
                           autocomplete="new-password"
                           data-lpignore="true">
                    <button class="password-toggle-btn" onclick="togglePassword('confirmPasswordChange')">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/>
                        </svg>
                    </button>
                </div>
            </div>
            <div class="input-group" id="passwordChange2FAField" style="display: none;">
                <label class="input-label">Google Authenticator Code (required):</label>
                <div class="code-input-container" id="changePasswordCodeContainer">
                    <input type="text" class="code-input" maxlength="1" data-index="0" autocomplete="off">
                    <input type="text" class="code-input" maxlength="1" data-index="1" autocomplete="off">
                    <input type="text" class="code-input" maxlength="1" data-index="2" autocomplete="off">
                    <input type="text" class="code-input" maxlength="1" data-index="3" autocomplete="off">
                    <input type="text" class="code-input" maxlength="1" data-index="4" autocomplete="off">
                    <input type="text" class="code-input" maxlength="1" data-index="5" autocomplete="off">
                </div>
            </div>
            <button class="button button-primary" onclick="changePassword()">Change Password</button>
        </div>
    </div>

    <div class="notification" id="notification"></div>

    <script>
        // Initialize 6-digit code inputs
        function initializeCodeInputs() {
            const containers = document.querySelectorAll('.code-input-container');
            
            containers.forEach(container => {
                const inputs = container.querySelectorAll('.code-input');
                
                inputs.forEach((input, index) => {
                    // Disable autocomplete on each input
                    input.setAttribute('autocomplete', 'off');
                    input.setAttribute('data-lpignore', 'true');
                    input.setAttribute('data-form-type', 'other');
                    
                    input.addEventListener('input', (e) => {
                        const value = e.target.value;
                        
                        if (value.length === 1) {
                            // Move to next input
                            if (index < inputs.length - 1) {
                                inputs[index + 1].focus();
                            } else {
                                // All digits entered, trigger submit
                                const code = Array.from(inputs).map(i => i.value).join('');
                                if (code.length === 6) {
                                    handleCodeComplete(container.id, code);
                                }
                            }
                        }
                    });
                    
                    input.addEventListener('keydown', (e) => {
                        if (e.key === 'Backspace' && !e.target.value && index > 0) {
                            inputs[index - 1].focus();
                        }
                    });
                    
                    // Handle paste
                    input.addEventListener('paste', (e) => {
                        e.preventDefault();
                        const pastedData = e.clipboardData.getData('text').replace(/\D/g, '').slice(0, 6);
                        
                        for (let i = 0; i < pastedData.length && i < inputs.length; i++) {
                            inputs[i].value = pastedData[i];
                        }
                        
                        if (pastedData.length === 6) {
                            handleCodeComplete(container.id, pastedData);
                        }
                    });
                });
            });
        }
        
        function handleCodeComplete(containerId, code) {
            // Handle different containers
            if (containerId === 'loginCodeContainer') {
                document.getElementById('login2FA').value = code;
            } else if (containerId === 'importCodeContainer') {
                document.getElementById('import2FA').value = code;
            } else if (containerId === 'verify2FAContainer') {
                document.getElementById('twoFactorCode').value = code;
            } else if (containerId === 'changePasswordCodeContainer') {
                document.getElementById('passwordChange2FA').value = code;
            }
        }
        
        function getCodeFromContainer(containerId) {
            const container = document.getElementById(containerId);
            const inputs = container.querySelectorAll('.code-input');
            return Array.from(inputs).map(i => i.value).join('');
        }
        
        function clearCodeContainer(containerId) {
            const container = document.getElementById(containerId);
            const inputs = container.querySelectorAll('.code-input');
            inputs.forEach(input => {
                input.value = '';
            });
            inputs[0].focus();
        }

        // Global state
        let walletState = {
            address: null,
            seedPhrase: null,
            balance: 0,
            encryptedData: null,
            isLoggedIn: false,
            transactions: [],
            twoFactorSecret: null,
            twoFactorEnabled: false,
            backupCodes: []
        };
        
        let sessionPassword = null;
        let updateInterval = null;
        
        const API_BASE = window.location.hostname === 'localhost' 
            ? 'http://localhost:5000/api'
            : '/api';

        // Utility functions
        function showError(message) {
            const errorDiv = document.getElementById('loginError');
            errorDiv.textContent = message;
            errorDiv.style.display = 'block';
            setTimeout(() => errorDiv.style.display = 'none', 5000);
        }
        
        function showSuccess(message) {
            const successDiv = document.getElementById('loginSuccess');
            successDiv.textContent = message;
            successDiv.style.display = 'block';
            setTimeout(() => successDiv.style.display = 'none', 5000);
        }
        
        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = `notification ${type}`;
            notification.style.display = 'block';
            
            setTimeout(() => {
                notification.style.display = 'none';
            }, 3000);
        }
        
        function togglePassword(fieldId) {
            const field = document.getElementById(fieldId);
            field.type = field.type === 'password' ? 'text' : 'password';
        }
        
        // Login functions
        function showCreateNewWallet() {
            document.getElementById('loginForm').style.display = 'none';
            document.getElementById('createWalletForm').style.display = 'block';
            document.getElementById('importWalletForm').style.display = 'none';
        }
        
        function showImportWallet() {
            document.getElementById('loginForm').style.display = 'none';
            document.getElementById('createWalletForm').style.display = 'none';
            document.getElementById('importWalletForm').style.display = 'block';
            
            // Clear code inputs
            clearCodeContainer('importCodeContainer');
        }
        
        function backToLogin() {
            document.getElementById('loginForm').style.display = 'block';
            document.getElementById('createWalletForm').style.display = 'none';
            document.getElementById('importWalletForm').style.display = 'none';
        }
        
        async function attemptLogin() {
            const password = document.getElementById('walletPassword').value;
            const twoFactorCode = getCodeFromContainer('loginCodeContainer');
            
            if (!password) {
                showError('Please enter your password');
                return;
            }
            
            const encryptedWallet = localStorage.getItem('qrcWalletEncrypted');
            
            if (!encryptedWallet) {
                showError('No wallet found. Please create a new wallet.');
                return;
            }
            
            try {
                // Decrypt wallet data
                const decrypted = CryptoJS.AES.decrypt(encryptedWallet, password);
                const decryptedStr = decrypted.toString(CryptoJS.enc.Utf8);
                
                if (!decryptedStr) {
                    showError('Invalid password');
                    return;
                }
                
                walletState = JSON.parse(decryptedStr);
                
                // Check if Google Authenticator is enabled
                if (walletState.twoFactorEnabled) {
                    if (!document.getElementById('login2FAField').style.display || document.getElementById('login2FAField').style.display === 'none') {
                        document.getElementById('login2FAField').style.display = 'block';
                        showError('Please enter your Google Authenticator code');
                        clearCodeContainer('loginCodeContainer');
                        return;
                    }
                    
                    if (!twoFactorCode) {
                        showError('Please enter your Google Authenticator code');
                        return;
                    }
                    
                    if (!verifyTOTP(walletState.twoFactorSecret, twoFactorCode)) {
                        showError('Invalid Google Authenticator code');
                        clearCodeContainer('loginCodeContainer');
                        return;
                    }
                }
                
                walletState.isLoggedIn = true;
                sessionPassword = password;
                
                // Show main app
                document.getElementById('loginScreen').style.display = 'none';
                document.getElementById('appContainer').style.display = 'block';
                
                // Initialize app
                initializeApp();
                showNotification('Welcome back!', 'success');
                
            } catch (error) {
                console.error('Login error:', error);
                showError('Failed to decrypt wallet. Please check your password.');
            }
        }
        
        async function importWallet() {
            const address = document.getElementById('importAddress').value.trim();
            const password = document.getElementById('importPassword').value;
            const twoFactorCode = getCodeFromContainer('importCodeContainer');
            
            if (!address || !password || !twoFactorCode) {
                showError('Please fill in all fields');
                return;
            }
            
            try {
                showSuccess('Checking wallet...');
                
                // Check if founder wallet
                const checkResponse = await fetch(`${API_BASE}/auth/check-wallet`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ address })
                });
                
                const checkData = await checkResponse.json();
                
                if (!checkData.success) {
                    showError('Invalid wallet address');
                    return;
                }
                
                if (!checkData.is_founder || !checkData.require_2fa) {
                    showError('This is not a founder wallet or Google Authenticator is not enabled');
                    return;
                }
                
                // Verify password
                const passwordResponse = await fetch(`${API_BASE}/auth/verify-password`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ address, password })
                });
                
                const passwordData = await passwordResponse.json();
                
                if (!passwordData.success) {
                    showError(passwordData.error || 'Invalid password');
                    return;
                }
                
                // Verify Google Authenticator
                const tfaResponse = await fetch(`${API_BASE}/auth/verify-2fa`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        temp_token: passwordData.temp_token,
                        otp: twoFactorCode,
                        device_id: getDeviceId(),
                        remember_device: false
                    })
                });
                
                const tfaData = await tfaResponse.json();
                
                if (!tfaData.success) {
                    showError(tfaData.error || 'Invalid Google Authenticator code');
                    clearCodeContainer('importCodeContainer');
                    return;
                }
                
                // Import successful - create local wallet
                walletState = {
                    address: tfaData.wallet_data.address,
                    balance: tfaData.wallet_data.balance,
                    isFounder: true,
                    features: tfaData.wallet_data.features,
                    sessionToken: tfaData.session_token,
                    twoFactorEnabled: true,
                    seedPhrase: generateSeedPhrase(), // Generate new seed for local storage
                    isLoggedIn: true
                };
                
                sessionPassword = password;
                
                // Encrypt and save
                const encrypted = CryptoJS.AES.encrypt(JSON.stringify(walletState), password).toString();
                localStorage.setItem('qrcWalletEncrypted', encrypted);
                
                // Show main app
                document.getElementById('loginScreen').style.display = 'none';
                document.getElementById('appContainer').style.display = 'block';
                
                // Initialize app
                initializeApp();
                showNotification('Founder wallet imported successfully!', 'success');
                
            } catch (error) {
                console.error('Import error:', error);
                showError('Failed to import wallet. Please check your connection.');
            }
        }
        
        // Additional functions
        function generateSeedPhrase() {
            // BIP39 word list (partial for demo - in production use full list)
            const wordList = ['abandon', 'ability', 'able', 'about', 'above', 'absent', 'absorb', 'abstract', 'absurd', 'abuse', 'access', 'accident', 'account', 'accuse', 'achieve', 'acid', 'acoustic', 'acquire', 'across', 'act'];
            const words = [];
            for (let i = 0; i < 24; i++) {
                words.push(wordList[Math.floor(Math.random() * wordList.length)]);
            }
            return words;
        }
        
        function getDeviceId() {
            let deviceId = localStorage.getItem('deviceId');
            if (!deviceId) {
                deviceId = 'device_' + Math.random().toString(36).substr(2, 9);
                localStorage.setItem('deviceId', deviceId);
            }
            return deviceId;
        }
        
        async function createNewWallet() {
            const password = document.getElementById('newPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            
            if (!password || password.length < 8) {
                showError('Password must be at least 8 characters');
                return;
            }
            
            if (password !== confirmPassword) {
                showError('Passwords do not match');
                return;
            }
            
            try {
                // Create wallet on server
                const response = await fetch(`${API_BASE}/wallet/create`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' }
                });
                
                const data = await response.json();
                
                if (data.success) {
                    // Generate seed phrase
                    const seedPhrase = generateSeedPhrase();
                    
                    // Create wallet state
                    walletState = {
                        address: data.address,
                        seedPhrase: seedPhrase,
                        balance: data.balance,
                        algorithm: data.algorithm,
                        publicKeySize: data.public_key_size,
                        signatureSize: data.signature_size,
                        isLoggedIn: true,
                        twoFactorEnabled: false,
                        twoFactorSecret: null,
                        transactions: []
                    };
                    
                    sessionPassword = password;
                    
                    // Encrypt and save
                    const encrypted = CryptoJS.AES.encrypt(JSON.stringify(walletState), password).toString();
                    localStorage.setItem('qrcWalletEncrypted', encrypted);
                    
                    showSuccess('Wallet created successfully!');
                    
                    // Show main app
                    document.getElementById('loginScreen').style.display = 'none';
                    document.getElementById('appContainer').style.display = 'block';
                    
                    // Initialize app
                    initializeApp();
                    
                    // Show seed phrase backup modal
                    setTimeout(() => {
                        showNotification('⚠️ Please backup your seed phrase immediately!', 'warning');
                        showSeedPhraseModal();
                    }, 1000);
                } else {
                    showError('Failed to create wallet');
                }
            } catch (error) {
                showError('Network error. Please try again.');
            }
        }
        
        function initializeApp() {
            // Update UI with wallet info
            document.getElementById('walletAddress').textContent = walletState.address;
            
            // Update security status
            if (walletState.twoFactorEnabled) {
                document.getElementById('twoFactorStatus').className = 'status-indicator status-enabled';
                document.getElementById('twoFactorStatus').innerHTML = '<span>●</span><span>Enabled</span>';
                document.getElementById('twoFactorFeature').className = 'security-feature feature-enabled';
                document.getElementById('securityStatusText').textContent = 'Secured with password + Google Authenticator + encryption';
            }
            
            // Update balance
            updateBalance();
            
            // Start real-time updates
            updateInterval = setInterval(() => {
                updateBalance();
                updateStats();
                updateTransactions();
            }, 5000);
            
            // Load initial data
            updateStats();
            updateTransactions();
        }
        
        async function updateBalance() {
            if (!walletState.address) return;
            
            try {
                const response = await fetch(`${API_BASE}/wallet/balance/${walletState.address}`);
                const data = await response.json();
                
                if (data.success) {
                    walletState.balance = data.balance;
                    document.getElementById('balance').textContent = `${data.balance.toFixed(2)} QRC`;
                    
                    // Update USD value (mock calculation)
                    const usdValue = data.balance * 0.50; // Mock price
                    document.querySelector('.balance-usd').textContent = `≈ ${usdValue.toFixed(2)} USD`;
                }
            } catch (error) {
                console.error('Balance update error:', error);
            }
        }
        
        async function updateStats() {
            try {
                const response = await fetch(`${API_BASE}/stats`);
                const data = await response.json();
                
                document.getElementById('tps').textContent = data.current_tps || '0';
                document.getElementById('blocks').textContent = data.block_height || '0';
                document.getElementById('transactions').textContent = data.total_transactions || '0';
                document.getElementById('users').textContent = data.active_users || '0';
            } catch (error) {
                console.error('Stats update error:', error);
            }
        }
        
        async function updateTransactions() {
            try {
                const response = await fetch(`${API_BASE}/transactions/recent`);
                const data = await response.json();
                
                if (data.success && data.transactions.length > 0) {
                    const transactionList = document.getElementById('recentTransactions');
                    transactionList.innerHTML = '';
                    
                    data.transactions.slice(0, 5).forEach(tx => {
                        const isReceived = tx.recipient === walletState.address;
                        const amount = tx.amount || 0;
                        
                        const txElement = document.createElement('div');
                        txElement.className = 'transaction-item';
                        txElement.innerHTML = `
                            <div class="transaction-info">
                                <div class="transaction-icon">
                                    ${isReceived ? '📥' : '📤'}
                                </div>
                                <div class="transaction-details">
                                    <h4>${isReceived ? 'Received' : 'Sent'}</h4>
                                    <span class="transaction-address">${isReceived ? tx.sender : tx.recipient}</span>
                                </div>
                            </div>
                            <div class="transaction-amount ${isReceived ? 'amount-positive' : 'amount-negative'}">
                                ${isReceived ? '+' : '-'}${amount.toFixed(2)} QRC
                            </div>
                        `;
                        transactionList.appendChild(txElement);
                    });
                }
            } catch (error) {
                console.error('Transaction update error:', error);
            }
        }
        
        // Tab management
        function showTab(tabName) {
            // Update nav links
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('data-tab') === tabName) {
                    link.classList.add('active');
                }
            });
            
            // Update tab content
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            const tabElement = document.getElementById(tabName + 'Tab');
            if (tabElement) {
                tabElement.classList.add('active');
            }
        }
        
        // Security functions
        function showTwoFactorModal() {
            if (walletState.twoFactorEnabled) {
                showNotification('Google Authenticator is already enabled', 'info');
                return;
            }
            
            // Generate secret
            const secret = generateTOTPSecret();
            walletState.twoFactorSecret = secret;
            
            // Generate QR code
            const otpauth = `otpauth://totp/QRC%20Wallet:${walletState.address}?secret=${secret}&issuer=QRC%20Wallet`;
            
            // Clear previous QR code
            document.getElementById('qrCodeContainer').innerHTML = '';
            
            // Generate new QR code
            new QRCode(document.getElementById('qrCodeContainer'), {
                text: otpauth,
                width: 200,
                height: 200,
                colorDark: '#000000',
                colorLight: '#ffffff'
            });
            
            // Show manual code
            document.getElementById('manualCode').textContent = secret.match(/.{1,4}/g).join(' ');
            
            // Clear code inputs
            clearCodeContainer('verify2FAContainer');
            
            document.getElementById('twoFactorModal').style.display = 'flex';
        }
        
        function generateTOTPSecret() {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ234567';
            let secret = '';
            for (let i = 0; i < 32; i++) {
                secret += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return secret;
        }
        
        function verify2FA() {
            const code = getCodeFromContainer('verify2FAContainer');
            
            if (!code || code.length !== 6) {
                showNotification('Please enter the 6-digit code from Google Authenticator', 'error');
                return;
            }
            
            if (verifyTOTP(walletState.twoFactorSecret, code)) {
                walletState.twoFactorEnabled = true;
                
                // Generate backup codes
                walletState.backupCodes = generateBackupCodes();
                
                // Save encrypted wallet
                const encrypted = CryptoJS.AES.encrypt(JSON.stringify(walletState), sessionPassword).toString();
                localStorage.setItem('qrcWalletEncrypted', encrypted);
                
                // Update UI
                document.getElementById('twoFactorStatus').className = 'status-indicator status-enabled';
                document.getElementById('twoFactorStatus').innerHTML = '<span>●</span><span>Enabled</span>';
                document.getElementById('twoFactorFeature').className = 'security-feature feature-enabled';
                document.getElementById('securityStatusText').textContent = 'Secured with password + Google Authenticator + encryption';
                
                closeModal('twoFactorModal');
                showNotification('Google Authenticator enabled successfully!', 'success');
                
                // Show backup codes
                setTimeout(() => {
                    showBackupCodesModal();
                }, 500);
            } else {
                showNotification('Invalid code. Please check Google Authenticator and try again.', 'error');
                clearCodeContainer('verify2FAContainer');
            }
        }
        
        function verifyTOTP(secret, token) {
            // Simple TOTP verification (in production, use server-side verification)
            const time = Math.floor(Date.now() / 1000 / 30);
            const expectedToken = generateTOTP(secret, time);
            const previousToken = generateTOTP(secret, time - 1);
            const nextToken = generateTOTP(secret, time + 1);
            
            return token === expectedToken || token === previousToken || token === nextToken;
        }
        
        function generateTOTP(secret, time) {
            // Simplified TOTP generation (in production, use proper library)
            const hash = CryptoJS.HmacSHA1(time.toString(), secret).toString();
            const offset = parseInt(hash.substr(-1), 16);
            const binary = parseInt(hash.substr(offset * 2, 8), 16) & 0x7fffffff;
            const otp = binary % 1000000;
            return otp.toString().padStart(6, '0');
        }
        
        function generateBackupCodes() {
            const codes = [];
            for (let i = 0; i < 10; i++) {
                const code = Math.random().toString(36).substr(2, 8).toUpperCase();
                codes.push(code);
            }
            return codes;
        }
        
        function showBackupCodesModal() {
            // Implementation for backup codes modal
            showNotification('Backup codes generated. Please save them securely.', 'info');
        }
        
        function showChangePasswordModal() {
            document.getElementById('currentPassword').value = '';
            document.getElementById('newPasswordChange').value = '';
            document.getElementById('confirmPasswordChange').value = '';
            
            if (walletState.twoFactorEnabled) {
                document.getElementById('passwordChange2FAField').style.display = 'block';
                clearCodeContainer('changePasswordCodeContainer');
            } else {
                document.getElementById('passwordChange2FAField').style.display = 'none';
            }
            
            document.getElementById('changePasswordModal').style.display = 'flex';
        }
        
        function changePassword() {
            const currentPassword = document.getElementById('currentPassword').value;
            const newPassword = document.getElementById('newPasswordChange').value;
            const confirmPassword = document.getElementById('confirmPasswordChange').value;
            const twoFactorCode = getCodeFromContainer('changePasswordCodeContainer');
            
            if (!currentPassword || !newPassword || !confirmPassword) {
                showNotification('Please fill in all password fields', 'error');
                return;
            }
            
            if (currentPassword !== sessionPassword) {
                showNotification('Current password is incorrect', 'error');
                return;
            }
            
            if (newPassword.length < 8) {
                showNotification('New password must be at least 8 characters', 'error');
                return;
            }
            
            if (newPassword !== confirmPassword) {
                showNotification('New passwords do not match', 'error');
                return;
            }
            
            if (walletState.twoFactorEnabled && !verifyTOTP(walletState.twoFactorSecret, twoFactorCode)) {
                showNotification('Invalid Google Authenticator code', 'error');
                clearCodeContainer('changePasswordCodeContainer');
                return;
            }
            
            // Update password
            sessionPassword = newPassword;
            
            // Re-encrypt wallet with new password
            const encrypted = CryptoJS.AES.encrypt(JSON.stringify(walletState), newPassword).toString();
            localStorage.setItem('qrcWalletEncrypted', encrypted);
            
            closeModal('changePasswordModal');
            showNotification('Password changed successfully!', 'success');
        }
        
        function showSeedPhraseModal() {
            // Implementation for seed phrase modal
            showNotification('Seed phrase backup feature coming soon', 'info');
        }
        
        function showExportPrivateKeyModal() {
            // Implementation for private key export
            showNotification('Private key export feature coming soon', 'info');
        }
        
        // Utility functions
        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }
        
        function copyAddress() {
            navigator.clipboard.writeText(walletState.address);
            showNotification('Address copied to clipboard!', 'success');
        }
        
        function showQRCode() {
            // Implementation for QR code display
            showNotification('QR code feature coming soon', 'info');
        }
        
        function refreshWallet() {
            updateBalance();
            updateStats();
            updateTransactions();
            showNotification('Wallet refreshed', 'success');
        }
        
        function logout() {
            if (confirm('Are you sure you want to logout?')) {
                walletState = {
                    address: null,
                    seedPhrase: null,
                    balance: 0,
                    encryptedData: null,
                    isLoggedIn: false,
                    transactions: []
                };
                
                sessionPassword = null;
                
                if (updateInterval) {
                    clearInterval(updateInterval);
                }
                
                document.getElementById('appContainer').style.display = 'none';
                document.getElementById('loginScreen').style.display = 'block';
                
                // Clear all input fields
                document.querySelectorAll('input').forEach(input => input.value = '');
                
                showNotification('Logged out successfully', 'info');
            }
        }
        
        // Initialize on page load
        document.addEventListener('DOMContentLoaded', () => {
            initializeCodeInputs();
            
            // Check for existing wallet
            const encryptedWallet = localStorage.getItem('qrcWalletEncrypted');
            if (encryptedWallet) {
                showSuccess('Wallet found. Please enter your password to unlock.');
            }
        });